"use strict";(self.webpackChunkhk_independent_bus_eta=self.webpackChunkhk_independent_bus_eta||[]).push([[516],{5516:function(e,n,t){t.r(n),t.d(n,{default:function(){return xe}});var r,a,o=t(9439),i=t(7313),c=t(6060),s=t(7829),l=t(4942),u=t(9099),d=t(9019),p=t(7592),h=t(2720),f=t(1479),m=t(9563),x=t(6417),b=function(e){var n=e.k,t=e.handleClick,r=e.disabled,a=void 0!==r&&r,o=e.className;return(0,x.jsx)(u.Z,{size:"large",variant:"contained",className:"".concat(C.button," ").concat(o),onClick:function(){return t(n)},disabled:a,disableRipple:!0,children:"b"===n?(0,x.jsx)(h.Z,{}):"c"===n?(0,x.jsx)(f.Z,{}):n})},g=function(e){var n=e.possibleChar,t=(0,i.useContext)(c.Z),r=t.numPadOrder,a=t.searchRoute,o=t.updateSearchRouteByButton;return(0,x.jsx)(d.ZP,{container:!0,spacing:0,children:r.split("").map((function(e){return(0,x.jsx)(d.ZP,{item:!0,xs:4,children:(0,x.jsx)(b,{k:e,handleClick:o,className:C.number,disabled:"b"===e&&""===a||!"bc".includes(e)&&!n.includes(e)||"c"===e&&""===a})},"input-"+e)}))})},Z=function(e){var n=e.possibleChar,t=(0,i.useContext)(c.Z).updateSearchRouteByButton;return(0,x.jsx)(d.ZP,{container:!0,spacing:1,children:n.filter((function(e){return isNaN(parseInt(e,10))})).map((function(e){return(0,x.jsx)(d.ZP,{item:!0,xs:12,children:(0,x.jsx)(b,{k:e,handleClick:t,className:C.alphabet})},"input-"+e)}))})},v=function(e){var n=e.boardTab,t=(0,i.useContext)(c.Z),r=t.searchRoute,a=t.db.routeList,o=T(r,a,n);return"prerendering"===navigator.userAgent?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)(y,{className:C.root,padding:0,children:[(0,x.jsx)(s.Z,{className:C.numPadContainer,padding:0,children:(0,x.jsx)(g,{possibleChar:o})}),(0,x.jsx)(s.Z,{className:C.alphabetPadContainer,padding:0,children:(0,x.jsx)(Z,{possibleChar:o})})]})},j="inputpad",C={root:"".concat(j,"-boxContainer"),numPadContainer:"".concat(j,"-numPadContainer"),alphabetPadContainer:"".concat(j,"-alphabetPadContainer"),button:"".concat(j,"-button"),alphabet:"".concat(j,"-alphabet"),cancel:"".concat(j,"-cancel"),number:"".concat(j,"-number")},y=(0,p.ZP)(s.Z)((function(e){var n,t=e.theme;return n={},(0,l.Z)(n,"&.".concat(C.root),{zIndex:0,background:t.palette.background.default,display:"flex",flexDirection:"row",height:"248px",justifyContent:"space-around"}),(0,l.Z)(n,"& .".concat(C.numPadContainer),{width:"72%"}),(0,l.Z)(n,"& .".concat(C.alphabetPadContainer),{width:"20%",height:"246px",overflowX:"hidden",overflowY:"scroll"}),(0,l.Z)(n,"& .".concat(C.button),{background:t.palette.background.paper,color:t.palette.text.primary,width:"100%",fontSize:"1.8em",borderRadius:"unset","&:selected":{color:t.palette.text.primary},"&:hover":{backgroundColor:t.palette.background.paper}}),(0,l.Z)(n,"& .".concat(C.cancel),{fontSize:"0.9em"}),(0,l.Z)(n,"& .".concat(C.alphabet),{height:"52px"}),(0,l.Z)(n,"& .".concat(C.number),{height:"62px"}),n})),T=function(e,n,t){if(null==n)return[];var r={};return Object.entries(n).forEach((function(n){var a=(0,o.Z)(n,2),i=a[0],c=a[1];if(i.startsWith(e.toUpperCase())&&c.co.some((function(e){return m.nR[t].includes(e)}))){var s=i.slice(e.length,e.length+1);r[s]=isNaN(r[s])?1:r[s]+1}})),Object.entries(r).map((function(e){return e[0]})).filter((function(e){return"-"!==e}))},k=t(4511),w=t(5823),N=t(8485),R=t(5280),S=function(e){var n=e.boardTab,t=e.onChangeTab,r=(0,k.$)().t;return(0,x.jsx)(s.Z,{sx:L,children:(0,x.jsx)(N.Z,{value:n,onChange:function(e,n){return t(n,!0)},sx:P,children:Object.keys(m.nR).map((function(e){return(0,x.jsx)(R.Z,{label:r(e),value:e,disableRipple:!0},e)}))})})},P=(a={background:function(e){return e.palette.background.default},minHeight:"36px",overflow:"auto",maxWidth:"100%"},(0,l.Z)(a,"& .MuiTab-root",(r={py:0,minWidth:"85px",minHeight:"32px"},(0,l.Z)(r,"&.Mui-selected",{color:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}}),(0,l.Z)(r,"&.MuiButtonBase-root",{textTransform:"none"}),r)),(0,l.Z)(a,"& .MuiTabs-indicator",{backgroundColor:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}}),(0,l.Z)(a,"& .MuiTabs-scroller",{overflow:"auto !important"}),a),L={background:function(e){return"dark"===e.palette.mode?e.palette.background.default:"white"}},W=t(2547),I=t(275),D=t(2429),B=t(3165),M=t(8566),z=t(6912),F=t(1113),O=t(3135),$=t(4183),H=t(8296),_=t(7131),A=t(3428),U=t(2135),E=function(e){var n=e.terminus,t=(0,k.$)(),r=t.t,a=t.i18n;return(0,x.jsxs)(q,{children:[(0,x.jsxs)("div",{className:Y.fromToWrapper,children:[(0,x.jsx)("span",{className:Y.fromToText,children:"".concat(r("\u5f80")," ")}),(0,x.jsx)(F.Z,{component:"h3",variant:"h6",className:Y.destination,children:(0,w.iF)(n.dest[a.language])})]}),(0,x.jsx)("div",{className:Y.fromWrapper,children:(0,x.jsx)(F.Z,{variant:"body2",children:(0,w.iF)(n.orig[a.language])})})]})},X="routeTerminus",Y={fromToWrapper:"".concat(X,"-fromToWrapper"),fromToText:"".concat(X,"-fromToText"),fromWrapper:"".concat(X,"-fromWrapper"),destination:"".concat(X,"-destination")},q=(0,p.ZP)("div")((function(e){var n,t=e.theme;return n={textAlign:"left"},(0,l.Z)(n,"& .".concat(Y.fromToWrapper),{display:"flex",alignItems:"baseline",whiteSpace:"nowrap",overflowX:"hidden"}),(0,l.Z)(n,"& .".concat(Y.fromToText),{fontSize:"0.95rem",marginRight:t.spacing(.5)}),(0,l.Z)(n,"& .".concat(Y.fromWrapper),{display:"flex",alignItems:"baseline",whiteSpace:"nowrap",overflowX:"hidden"}),(0,l.Z)(n,"& .".concat(Y.destination),{fontWeight:700}),n})),G=t(9530),J=function(e){var n=e.route,t=(0,k.$)().t,r=n[0].split("-").slice(0,2),a=(0,o.Z)(r,2),i=a[0],c=a[1];return(0,x.jsxs)(V,{children:[(0,x.jsxs)("div",{children:[(0,x.jsx)(G.Z,{routeNo:i}),parseInt(c,10)>=2&&(0,x.jsx)(F.Z,{variant:"caption",className:Q.specialTrip,children:t("\u7279\u5225\u73ed")})]}),(0,x.jsx)(F.Z,{component:"h4",variant:"caption",className:Q.company,children:n[1].co.map((function(e){return t(e)})).join("+")})]})},K="routeNoCompany",Q={company:"".concat(K,"-company"),specialTrip:"".concat(K,"-specialTrip")},V=(0,p.ZP)("div")((function(e){var n,t=e.theme;return n={},(0,l.Z)(n,"& .".concat(Q.company),{color:t.palette.text.secondary}),(0,l.Z)(n,"& .".concat(Q.specialTrip),{fontSize:"0.6rem",marginLeft:"8px"}),n})),ee=t(8586),ne=function(e){var n=e.route,t=e.handleClick,r=e.style,a=e.onRemove,o=(0,k.$)().i18n;return(0,x.jsx)(U.rU,{to:"/".concat(o.language,"/route/").concat(n[0].toLowerCase()),style:r,children:(0,x.jsxs)(ae,{variant:"outlined",square:!0,children:[(0,x.jsx)($.Z,{onClick:t,children:(0,x.jsxs)(H.Z,{className:re.cardContent,children:[(0,x.jsx)(J,{route:n}),(0,x.jsx)(E,{terminus:n[1]})]})}),null!==a&&(0,x.jsx)(_.Z,{onClick:a,children:(0,x.jsx)(ee.Z,{onClick:a})})]},n[0])})},te="routeRow",re={cardContent:"".concat(te,"-cardContent"),searchContent:"".concat(te,"-searchContent")},ae=(0,p.ZP)(A.Z)((function(e){var n,t=e.theme;return n={border:"none"},(0,l.Z)(n,"& .".concat(re.cardContent),{display:"grid",gridTemplateColumns:"25% 65%",padding:"".concat(t.spacing(.5)," ").concat(t.spacing(2)),alignItems:"center"}),(0,l.Z)(n,"display","flex"),(0,l.Z)(n,"alignItems","center"),n})),oe=t(8467),ie=i.memo((function(e){var n=e.data,t=n.routeList,r=n.vibrateDuration,a=n.tab,o=e.index,s=e.style,l=t[o],u=(0,i.useContext)(c.Z),d=u.addSearchHistory,p=u.removeSearchHistoryByRouteId,h=(0,k.$)().i18n,f=(0,oe.s0)();return(0,x.jsx)(ne,{handleClick:function(e){e.preventDefault(),(0,w.tp)(r),d(l[0]),setTimeout((function(){f("/".concat(h.language,"/route/").concat(l[0].toLowerCase()))}),0)},route:l,style:s,onRemove:"recent"===a?function(e){e.preventDefault(),(0,w.tp)(r),p(l[0])}:null})}),B.wy),ce=(0,z.Z)((function(e,n,t){return{routeList:e,vibrateDuration:n,tab:t}})),se=(0,I.yP)((0,I.p6)(W.ZP)),le=function(e){var n=e.boardTab,t=e.onChangeTab,r=(0,i.useContext)(c.Z),a=r.searchRoute,l=r.db,u=l.holidays,d=l.routeList,p=r.isRouteFilter,h=r.busSortOrder,f=r.routeSearchHistory,b=r.vibrateDuration,g=(0,i.useMemo)((function(){return(0,O.HD)(u,new Date)}),[u]),Z=(0,k.$)().t,v=(0,i.useMemo)((function(){var e=Object.entries(d).filter((function(e){var n=(0,o.Z)(e,2),t=n[0],r=n[1],i=r.stops,c=r.co;return t.startsWith(a.toUpperCase())&&(null==i[c[0]]||i[c[0]].length>0)})).filter((function(e){var n=(0,o.Z)(e,2),t=n[0],r=n[1].freq;return!p||(0,O.x4)(t,r,g)})).sort((function(e,n){return(0,w.nO)(e,n,m.Y$[h])}));return Object.entries(m.nR).map((function(n,t){var r=(0,o.Z)(n,2),i=r[0],c=r[1];return ce("recent"===i?f.filter((function(e){return e.startsWith(a.toUpperCase())})).filter((function(e){return d[e]})).map((function(e){return[e,d[e]]})):e.filter((function(e){var n=(0,o.Z)(e,2);n[0];return n[1].co.some((function(e){return c.includes(e)}))})),b,i)}))}),[d,g,a,p,b,h,f]),j=(0,i.useCallback)((function(e){var n=e.key,t=e.index;return(0,x.jsx)(i.Fragment,{children:v[t].routeList.length>0?(0,x.jsx)(M.Z,{children:function(e){var n=e.height,r=e.width;return(0,x.jsx)(B.t7,{height:.98*n,itemCount:v[t].routeList.length,itemSize:64,width:r,itemData:v[t],className:pe.root,children:ie})}}):(0,x.jsxs)(s.Z,{sx:fe,children:[(0,x.jsx)(D.Z,{fontSize:"small"}),(0,x.jsx)(s.Z,{children:t>0?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(F.Z,{variant:"h6",children:['"',a,'"']}),(0,x.jsx)(F.Z,{variant:"h6",children:Z("route-search-no-result")})]}):(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(F.Z,{variant:"h6",children:Z("no-recent-search")})})})]})},n)}),[v,a,Z]);return(0,i.useMemo)((function(){return(0,x.jsx)(x.Fragment,{children:"prerendering"===navigator.userAgent?(0,x.jsx)(he,{className:pe.prerenderList,children:v[0].routeList.map((function(e,n){return(0,x.jsx)(ie,{data:v[0],index:n,style:null},"route-".concat(n))}))}):(0,x.jsx)(se,{index:ue.indexOf(n),onChangeIndex:function(e){t(ue[e])},style:{flex:1,display:"flex"},containerStyle:{flex:1},slideCount:v.length,overscanSlideAfter:1,overscanSlideBefore:1,slideRenderer:j,enableMouseEvents:!0})})}),[j,v,t,n])},ue=["recent","all","bus","minibus","lightRail","mtr"],de="routeBoard",pe={root:"".concat(de,"-root"),prerenderList:"".concat(de,"-prerenderList"),noResult:"".concat(de,"-noResult")},he=(0,p.ZP)("div")((function(e){e.theme;return(0,l.Z)({},"&.".concat(pe.prerenderList),{height:"100%",overflowY:"scroll"})})),fe=(0,l.Z)({height:"140px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},"& .MuiSvgIcon-root",{fontSize:"4rem",mr:2}),me=function(e){var n=e.boardTab,t=e.setBoardTab,r=(0,i.useContext)(c.Z).AppTitle,a=(0,k.$)(),o=a.t,l=a.i18n;(0,i.useEffect)((function(){(0,w.ND)({title:o("\u641c\u5c0b")+" - "+o(r),description:o("route-board-page-description"),lang:l.language})}),[l.language]);var u=(0,i.useCallback)((function(e){t(e),localStorage.setItem("boardTab",e)}),[t]);return(0,x.jsxs)(s.Z,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[(0,x.jsx)(S,{boardTab:n,onChangeTab:u}),(0,x.jsx)(le,{boardTab:n,onChangeTab:u})]})},xe=function(){var e,n=localStorage.getItem("boardTab"),t=(0,i.useState)("recent"===(e=n)||"all"===e||"bus"===e||"minibus"===e||"lightRail"===e||"mtr"===e?n:"all"),r=(0,o.Z)(t,2),a=r[0],c=r[1];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(me,{boardTab:a,setBoardTab:c}),(0,x.jsx)(v,{boardTab:a})]})}}}]);