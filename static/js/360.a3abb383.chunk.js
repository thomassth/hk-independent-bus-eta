"use strict";(self.webpackChunkhk_independent_bus_eta=self.webpackChunkhk_independent_bus_eta||[]).push([[360],{2683:function(e,t,n){n.r(t),n.d(t,{default:function(){return Jt}});var o,r,a=n(1413),i=n(7313),c=n(7912),s=(n(3331),n(7458)),l=n(4778),u=n(6396),d=n(2135),p=n(8467),f=n(3346),x=n(5296),g=n(6060),h=n(178),m=n(2481),Z=n(7829),j=n(4942),b=n(9237),v=n(9856),y=n(5919),C=n(7983),k=n(180),w=n(4737),_=n(2495),S=n(4511),T=n(7592),I=n(5823),N=n(6417),W=function(){var e=(0,S.$)(),t=e.t,n=e.i18n,o=(0,p.TH)(),r=(0,i.useContext)(g.Z),a=r.selectedRoute,c=r.colorMode,s=r.vibrateDuration,l=(0,p.s0)(),u=function(e,t){t.preventDefault(),(0,I.tp)(s),setTimeout((function(){return l(e)}),0)};return(0,i.useMemo)((function(){return(0,N.jsxs)(P,{value:o.pathname.replace(/(.*)\/[0-9]*?$/,"$1"),showLabels:!0,classes:{root:A.root},children:[(0,N.jsx)(b.Z,{label:t("\u9996\u9801"),component:d.rU,to:"/".concat(n.language),onClick:function(e){return u("/".concat(n.language),e)},value:"/".concat(n.language),icon:(0,N.jsx)(y.Z,{}),classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(b.Z,{label:t("\u641c\u5c0b"),component:d.rU,to:"/".concat(n.language,"/board"),onClick:function(e){return u("/".concat(n.language,"/board"),e)},value:"/".concat(n.language,"/board"),icon:(0,N.jsx)(C.Z,{}),classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(b.Z,{label:a.split("-")[0],component:d.rU,to:"/".concat(n.language,"/route/").concat(a.replace(/(.*)\/.*$/,"$1").toLowerCase()),onClick:function(e){return u("/".concat(n.language,"/route/").concat(a.toLowerCase()),e)},value:"/".concat(n.language,"/route/").concat(a.replace(/(.*)\/.*$/,"$1").toLowerCase()),icon:(0,N.jsx)(w.Z,{}),style:{textTransform:"uppercase"},classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(b.Z,{label:t("\u898f\u5283"),component:d.rU,to:"/".concat(n.language,"/search"),onClick:function(e){return u("/".concat(n.language,"/search"),e)},value:"/".concat(n.language,"/search"),icon:(0,N.jsx)(k.Z,{}),classes:{root:"footer-actionItem",selected:"footer-selected"}}),(0,N.jsx)(b.Z,{label:t("\u8a2d\u5b9a"),component:d.rU,to:"/".concat(n.language,"/settings"),rel:"nofollow",onClick:function(e){return u("/".concat(n.language,"/settings"),e)},value:"/".concat(n.language,"/settings"),icon:(0,N.jsx)(_.Z,{}),classes:{root:"footer-actionItem",selected:A.selected}})]})}),[o.pathname,n.language,c,a,s])},R="footer",A={root:"".concat(R,"-root"),selected:"".concat(R,"-selected")},P=(0,T.ZP)(v.Z)((function(e){var t,n=e.theme;return(0,j.Z)({},"&.".concat(A.root),(t={background:"dark"===n.palette.mode?n.palette.background.default:n.palette.primary.main,bottom:"0",height:"initial"},(0,j.Z)(t,"& .MuiBottomNavigationAction-root",{width:"20%",padding:"6px 0",minWidth:0}),(0,j.Z)(t,"& .MuiBottomNavigationAction-label",{fontSize:"0.875rem"}),(0,j.Z)(t,"& .Mui-selected.".concat(A.selected),{color:"dark"===n.palette.mode?n.palette.primary.main:n.palette.text.primary}),t))})),D=n(1113),E=n(2461),H=n(8119),L=n(7131),M=n(9099),$=n(9289),F=n(647),O=n(9439),z=function(){var e=(0,i.useState)({}),t=(0,O.Z)(e,2),n=t[0],o=t[1];return(0,i.useEffect)((function(){var e=!0,t=function(){return"prerendering"===navigator.userAgent?(o({}),new Promise((function(e){return e([])}))):fetch("https://data.weather.gov.hk/weatherAPI/opendata/weather.php?dataType=warnsum&lang=en").then((function(e){return e.json()})).then((function(t){e&&o(t)}))},n=setInterval((function(){t()}),3e5);return t(),function(){e=!1,clearInterval(n)}}),[o]),n},B=["TC10","TC9","TC8SW","TC8NW","TC8SE","TC8NE","WRAINB","WRAINR","TC3","TC1","WRAINA","WL","WTS","WFNTSA","WHOT","WCOLD","WMSGNL"],U={TC10:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/No._10_Hurricane_Signal.png/30px-No._10_Hurricane_Signal.png",TC9:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/No._09_Increasing_Gale_or_Storm_Signal.png/30px-No._09_Increasing_Gale_or_Storm_Signal.png",TC8SW:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/No._8_Southwest_Gale_or_Storm_Signal.png/30px-No._8_Southwest_Gale_or_Storm_Signal.png",TC8NW:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/No._8_Northwest_Gale_or_Storm_Signal.png/30px-No._8_Northwest_Gale_or_Storm_Signal.png",TC8SE:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/No._8_Southeast_Gale_or_Storm_Signal.png/30px-No._8_Southeast_Gale_or_Storm_Signal.png",TC8NE:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/No._8_Northeast_Gale_or_Storm_Signal.png/30px-No._8_Northeast_Gale_or_Storm_Signal.png",WRAINB:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c0/Black_Rainstorm_Signal.png/25px-Black_Rainstorm_Signal.png",WRAINR:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Red_Rainstorm_Signal.png/25px-Red_Rainstorm_Signal.png",TC3:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/No._03_Strong_Wind_Signal.png/30px-No._03_Strong_Wind_Signal.png",TC1:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/No._01_Standby_Signal.png/30px-No._01_Standby_Signal.png",WRAINA:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Amber_Rainstorm_Signal.png/25px-Amber_Rainstorm_Signal.png",WL:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5b/Landslip.gif/25px-Landslip.gif",WTS:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Thunderstorm_Warning.png/25px-Thunderstorm_Warning.png",WFNTSA:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Ntfl.gif/25px-Ntfl.gif",WHOT:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Very_Hot_Weather_Warning.png/25px-Very_Hot_Weather_Warning.png",WCOLD:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Cold_Weather_Warning.png/25px-Cold_Weather_Warning.png",WMSGNL:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/HK_Monsoon_Signal.png/25px-HK_Monsoon_Signal.png"},G=function(){var e=(0,i.useContext)(g.Z),t=e.searchRoute,n=e.setSearchRoute,o=e.db.routeList,r=e.colorMode,a=e.vibrateDuration,c=e.geoPermission,s=e.updateGeolocation,l=e.changeLanguage,u=(0,S.$)(),f=u.t,x=u.i18n,h=(0,p.TH)(),m=(0,p.s0)(),j=function(){var e=z();return Object.values(e).map((function(e){return e.code})).filter((function(e){return B.indexOf(e)>=0})).sort((function(e,t){return B.indexOf(e)<B.indexOf(t)?-1:1}))}(),b=(0,i.useCallback)((function(){try{navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,o=t.longitude;s({lat:n,lng:o})}))}catch(e){console.log("error in getting location")}}),[s]),v=(0,i.useCallback)((function(e){var o=e.key,r=e.ctrlKey,a=e.altKey,i=e.metaKey,c=e.target;r||a||i||"INPUT"!==c.tagName.toUpperCase()&&"TEXTAREA"!==c.tagName.toUpperCase()&&("Escape"===o?n(""):"Backspace"===o?n(t.slice(0,-1)):1===o.length&&(n(t+o),m("/".concat(x.language,"/board"),{replace:!0})))}),[t,x.language,n]);return(0,i.useEffect)((function(){return window.addEventListener("keydown",v),function(){window.removeEventListener("keydown",v)}}),[v]),(0,i.useMemo)((function(){return(0,N.jsxs)(V,{className:K.toolbar,children:[(0,N.jsx)(d.rU,{to:"/".concat(x.language),onClick:function(e){e.preventDefault(),(0,I.tp)(a),m("/".concat(x.language))},rel:"nofollow",children:(0,N.jsx)(D.Z,{component:"h1",variant:"subtitle2",className:K.appTitle,children:f("\u5df4\u58eb\u5230\u7ad9\u9810\u5831")})}),(0,N.jsx)(E.Z,{id:"searchInput",className:K.searchRouteInput,type:"text",value:t,placeholder:f("\u5df4\u58eb\u7dda"),onChange:function(e){(e.target.value.toUpperCase()in o||e.target.value in o)&&(document.activeElement.blur(),m("/".concat(x.language,"/route/").concat(e.target.value))),n(e.target.value)},onFocus:function(){(0,I.tp)(a),"prerendering"!==navigator.userAgent&&(0,I.z4)()&&document.activeElement.blur(),m("/".concat(x.language,"/board"),{replace:!0})}}),(0,N.jsxs)(Z.Z,{className:K.funcPanel,children:[j.slice(0,2).map((function(e){return(0,N.jsx)(H.Z,{onClick:function(){return window.open("https://www.hko.gov.hk/".concat("zh"===x.language?"tc":"en","/detail.htm"))},variant:"square",src:U[e],sx:Q},e)})),"granted"===c&&(0,N.jsx)(L.Z,{"aria-label":"relocate",onClick:function(){return b()},children:(0,N.jsx)(F.Z,{})}),(0,N.jsx)(M.Z,{sx:J,onClick:function(){return e="zh"===x.language?"en":"zh",(0,I.tp)(a),m(h.pathname.replace("/"+x.language,"/"+e),{replace:!0}),void l(e);var e},id:"lang-selector",variant:"text",disableElevation:!0,disableRipple:!0,children:"zh"!==x.language?"\u7e41":"En"}),(0,N.jsx)(L.Z,{component:d.rU,to:"/".concat(x.language,"/settings"),rel:"nofollow",children:(0,N.jsx)(_.Z,{fontSize:"small"})})]})]})}),[t,x.language,h.pathname,r,c,a,j])},q="header",K={toolbar:"".concat(q,"-toolbar"),appTitle:"".concat(q,"-appTitle"),searchRouteInput:"".concat(q,"-searchRouteInput"),funcPanel:"".concat(q,"-funcPanel")},V=(0,T.ZP)($.Z)((function(e){var t,n=e.theme;return t={},(0,j.Z)(t,"& .".concat(K.appTitle),{color:"dark"===n.palette.mode?n.palette.primary.main:n.palette.text.primary}),(0,j.Z)(t,"&.".concat(K.toolbar),{backgroundColor:"dark"===n.palette.mode?n.palette.background.default:n.palette.primary.main,"& a":{textDecoration:"none"},display:"flex",justifyContent:"space-between",paddingLeft:n.spacing(1),paddingRight:n.spacing(1)}),(0,j.Z)(t,"& .".concat(K.searchRouteInput),{maxWidth:"100px","& input":{textAlign:"center"},"& input::before":{borderBottom:"1px ".concat(n.palette.text.primary," solid")}}),(0,j.Z)(t,"& .".concat(K.funcPanel),{display:"flex",alignItems:"center"}),t})),J={color:function(e){return e.palette.text.primary},minWidth:"40px",p:1,borderRadius:5,fontWeight:900,textTransform:"none"},Q={background:"white",height:24,width:24,m:1},X=function(){var e=(0,S.$)().t,t=(0,i.useContext)(g.Z),n=t.analytics,o=t.toggleAnalytics,r=(0,i.useState)(!n&&!Boolean(localStorage.getItem("consent"))&&!(0,I.vS)()),a=(0,O.Z)(r,2),c=a[0],s=a[1],l=(0,i.useCallback)((function(){o(),s((function(){return localStorage.setItem("consent","yes"),!1}))}),[s,o]),u=(0,i.useCallback)((function(){s((function(){return localStorage.setItem("consent","no"),!1}))}),[s]);return c?(0,N.jsxs)(Z.Z,{sx:Y,children:[(0,N.jsx)(D.Z,{variant:"subtitle2",sx:te,children:e("We'd like to set analytics cookies that help us improve hkbus.app by measuring how you use it.")}),(0,N.jsxs)(Z.Z,{sx:ee,children:[(0,N.jsx)(M.Z,{size:"small",variant:"contained",sx:{color:"#000"},onClick:l,children:e("Accept")}),(0,N.jsx)(M.Z,{size:"small",variant:"outlined",color:"error",onClick:u,children:e("Reject")})]})]}):(0,N.jsx)(N.Fragment,{})},Y={background:"#333",display:"flex",alignSelf:"flex-end"},ee={display:"flex",alignItems:"center",gap:1,p:1},te={p:1,color:"#fff"},ne=n(3947),oe=n(6330),re=n(3795),ae=n(7943),ie=function(e){var t=e.name,n=e.list,o=e.collectionIdx,r=void 0===o?null:o,c=(0,S.$)().t,s=(0,i.useContext)(g.Z),l=s.collectionDrawerRoute,u=s.db.routeList,d=s.toggleCollectionDialog,p=s.toggleCollectionEta;return(0,N.jsxs)(Z.Z,{sx:ce,children:[(0,N.jsxs)(Z.Z,{sx:(0,a.Z)((0,a.Z)({},se),{},{cursor:null!==r?"pointer":"auto"}),onClick:function(){return d(r)},children:[(0,N.jsx)(H.Z,{children:t.charAt(0)}),(0,N.jsxs)(Z.Z,{sx:le,children:[(0,N.jsx)(D.Z,{variant:"body1",children:t}),(0,N.jsxs)(D.Z,{variant:"caption",children:[c("Number of ETAs: "),n.filter((function(e){return void 0!==u[e.split("/")[0]]})).length]})]})]}),(0,N.jsx)(Z.Z,{sx:ue,children:(0,N.jsx)(oe.Z,{icon:(0,N.jsx)(re.Z,{}),checkedIcon:(0,N.jsx)(ae.Z,{}),checked:n.includes(l),onClick:function(){return p(l,r)}})})]})},ce={flex:1,display:"flex",justifyContent:"space-between"},se={display:"flex",alignItems:"center",gap:2,flex:1},le={display:"flex",flexDirection:"column"},ue={display:"flex"},de=n(6555),pe=n(2040),fe=n(4469),xe=n(6467),ge=n(2392),he=n(8485),me=n(5280),Ze=n(4117),je=n(7605),be=n(7327),ve=n(3208),ye=n(9765),Ce=n(5904),ke=n(8443),we=n(8790),_e=n(658),Se=n.n(_e),Te=function(){var e=(0,S.$)().t,t=(0,i.useContext)(g.Z),n=t.collections,o=t.collectionIdx,r=t.updateCollectionSchedule,a=t.addCollectionSchedule,c=t.removeCollectionSchedule;return(0,N.jsx)(ve._,{dateAdapter:Ce.y,children:(0,N.jsxs)(Z.Z,{sx:Ie,children:[n[o].schedules.map((function(t,n){return(0,N.jsxs)(Z.Z,{sx:Ne,children:[(0,N.jsx)(L.Z,{size:"small",onClick:function(){return c(n)},children:(0,N.jsx)(ke.Z,{})}),(0,N.jsx)(ge.Z,{variant:"standard",value:t.day,select:!0,size:"small",onChange:function(e){var t=e.target.value;return r(n,"day",parseInt(t))},children:Array(7).fill(0).map((function(t,o){return(0,N.jsx)(be.Z,{value:o,children:e("weekday-".concat(o))},"option-".concat(n,"-").concat(o))}))}),(0,N.jsx)(ye.d,{sx:{flex:.45},slotProps:{textField:{size:"small",variant:"standard"}},value:Se()("1991-12-02".concat(t.start.hour,":").concat(t.start.minute)),onChange:function(e){return r(n,"start",{hour:e.$H,minute:e.$m})}}),"-",(0,N.jsx)(ye.d,{sx:{flex:.45},slotProps:{textField:{size:"small",variant:"standard"}},value:Se()("1991-12-02T".concat(t.end.hour,":").concat(t.end.minute)),onChange:function(e){return r(n,"end",{hour:e.$H,minute:e.$m})}})]},"schedule-".concat(n))})),(0,N.jsx)(M.Z,{onClick:function(){return a()},children:(0,N.jsx)(we.Z,{})})]})})},Ie={display:"flex",flexDirection:"column",gap:1.5,fontSize:"0.8em !important"},Ne={display:"flex",justifyContent:"space-between",alignItems:"center",gap:.5},We=n(1757),Re=n(1660),Ae=function(){var e=(0,i.useContext)(g.Z),t=e.db.routeList,n=e.collections,o=e.collectionIdx,r=e.setCollectionEtas,c=(0,i.useState)(n[o].list.filter((function(e){return e.split("/")[0]in t})).reverse()),s=(0,O.Z)(c,2),l=s[0],u=s[1],d=(0,S.$)().t,p=(0,i.useCallback)((function(e){var t=e.destination,n=e.source;if(t){var o=(0,I.HP)(l,n.index,t.index);u(o),r(Array.from(o).reverse())}}),[l,u,r]);return(0,N.jsx)(We.Z5,{onDragEnd:p,children:(0,N.jsx)(We.bK,{droppableId:"saved-eta-list",children:function(e){return(0,N.jsxs)(Z.Z,(0,a.Z)((0,a.Z)({ref:e.innerRef},e.droppableProps),{},{children:[l.length?l.map((function(e,t){return(0,N.jsx)(Pe,{item:e,index:t},"savedEta-".concat(e))})):(0,N.jsx)(D.Z,{sx:{textAlign:"center",marginTop:5},children:(0,N.jsx)("b",{children:d("\u672a\u6709\u6536\u85cf\u5605\u8def\u7dda\u3002")})}),e.placeholder]}))}})})},Pe=function(e){var t=e.item,n=e.index;return(0,N.jsx)(We._l,{draggableId:t,index:n,children:function(e){return(0,N.jsx)(Z.Z,(0,a.Z)((0,a.Z)((0,a.Z)({ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:(0,N.jsx)(Re.Z,{routeId:t,disabled:!0})}))}})},De=function(){var e=(0,i.useContext)(g.Z),t=e.collections,n=e.collectionIdx,o=e.toggleCollectionDialog,r=e.updateCollectionName,a=e.removeCollection,c=(0,S.$)().t,s=(0,i.useState)("routes"),l=(0,O.Z)(s,2),u=l[0],d=l[1];return null===n?null:(0,N.jsxs)(fe.Z,{open:null!==n,onClose:function(){o(null)},fullWidth:!0,children:[(0,N.jsxs)(xe.Z,{sx:Ee,children:[(0,N.jsx)(ge.Z,{id:"collection-input",variant:"standard",value:t[n].name,onChange:function(e){var t=e.target.value;return r(t)},fullWidth:!0}),(0,N.jsxs)(he.Z,{value:u,onChange:function(e,t){return d(t)},sx:$e,children:[(0,N.jsx)(me.Z,{value:"routes",label:c("\u8def\u7dda")}),(0,N.jsx)(me.Z,{value:"time",label:c("\u986f\u793a\u6642\u9593")})]}),(0,N.jsxs)(Z.Z,{sx:He,children:["routes"===u&&(0,N.jsx)(Ae,{}),"time"===u&&(0,N.jsx)(Te,{})]})]}),(0,N.jsx)(Ze.Z,{sx:Le,children:(0,N.jsx)(L.Z,{onClick:function(){return a(n)},sx:Me,children:(0,N.jsx)(je.Z,{})})})]})},Ee={display:"flex",flexDirection:"column",gap:1},He={height:"50vh",pr:1,overflow:"scroll","&::-webkit-scrollbar":{display:"none"}},Le={display:"flex",justifyContent:"flex-start"},Me={opacity:.3,"&:hover":{opacity:1}},$e=(o={minHeight:"36px"},(0,j.Z)(o,"& .MuiTab-root",(0,j.Z)({alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0,minHeight:"32px"},"&.Mui-selected",{color:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}})),(0,j.Z)(o,"& .MuiTabs-flexContainer",{justifyContent:"center"}),(0,j.Z)(o,"& .MuiTabs-indicator",{backgroundColor:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}}),o),Fe=function(){var e=(0,S.$)().t,t=(0,i.useContext)(g.Z),n=t.collectionDrawerRoute,o=t.setCollectionDrawerRoute,r=t.savedEtas,a=t.collections,c=t.addNewCollection;return(0,N.jsxs)(ne.ZP,{anchor:"bottom",open:null!==n,onClose:function(){return o(null)},PaperProps:{sx:Oe},children:[(0,N.jsxs)(Z.Z,{sx:ze,children:[(0,N.jsx)(de.Z,{sx:Be}),(0,N.jsx)(Z.Z,{sx:Ue,children:(0,N.jsx)(ie,{name:e("\u5e38\u7528"),list:r})}),(0,N.jsxs)(Z.Z,{sx:Ge,children:[(0,N.jsx)(D.Z,{variant:"h6",children:e("Collections")}),(0,N.jsx)(L.Z,{onClick:c,children:(0,N.jsx)(pe.Z,{})})]}),(0,N.jsx)(Z.Z,{sx:qe,children:a.map((function(e,t){var n=e.name,o=e.list;return(0,N.jsx)(ie,{name:n,list:o,collectionIdx:t},"collection-".concat(t))}))})]}),(0,N.jsx)(De,{})]})},Oe={borderTopLeftRadius:10,borderTopRightRadius:10},ze={maxHeight:"50vh",minHeight:"30vh",display:"flex",flexDirection:"column",px:2,py:1},Be={alignSelf:"center"},Ue={display:"flex",mb:1},Ge={display:"flex",justifyContent:"space-between"},qe={display:"flex",flexDirection:"column",gap:2,overflow:"scroll"},Ke={display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},Ve={display:"flex",flexDirection:"column",flex:1,overflow:"hidden",backgroundColor:function(e){return e.palette.background.default}},Je=function(){return(0,N.jsxs)(h.Z,{maxWidth:"xs",disableGutters:!0,sx:Ke,children:[(0,N.jsx)(m.ZP,{}),(0,N.jsx)(G,{}),(0,N.jsxs)(Z.Z,{sx:Ve,children:[(0,N.jsx)(X,{}),(0,N.jsx)(p.j3,{})]}),(0,N.jsx)(W,{}),(0,N.jsx)(Fe,{})]})},Qe=n(501),Xe=n(282),Ye=n(936),et=n.n(Ye),tt=n(9622),nt=n(6584),ot=n(5943),rt=function(e){var t=e.homeTab,n=e.onChangeTab,o=(0,S.$)().t;return(0,N.jsxs)(he.Z,{value:t,onChange:function(e,t){return n(t,!0)},sx:at,children:[(0,N.jsx)(me.Z,{iconPosition:"start",icon:(0,N.jsx)(tt.Z,{}),label:o("\u7d9c\u5408"),value:"both",disableRipple:!0}),(0,N.jsx)(me.Z,{iconPosition:"start",icon:(0,N.jsx)(nt.Z,{}),label:o("\u5e38\u7528"),value:"saved",disableRipple:!0}),(0,N.jsx)(me.Z,{iconPosition:"start",icon:(0,N.jsx)(ot.Z,{}),label:o("\u9644\u8fd1"),value:"nearby",disableRipple:!0}),(0,N.jsx)(me.Z,{iconPosition:"start",icon:(0,N.jsx)(ae.Z,{}),label:o("Collections"),value:"collections",disableRipple:!0})]})},at=(r={background:function(e){return e.palette.background.default},minHeight:"36px"},(0,j.Z)(r,"& .MuiTab-root",(0,j.Z)({alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0,minHeight:"32px"},"&.Mui-selected",{color:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}})),(0,j.Z)(r,"& .MuiTabs-flexContainer",{justifyContent:"center"}),(0,j.Z)(r,"& .MuiTabs-indicator",{backgroundColor:function(e){return"dark"===e.palette.mode?e.palette.primary.main:"black"}}),r),it=n(4183),ct=n(8296),st=n(3428),lt=function(){var e=(0,S.$)().t,t=z();return"prerendering"!==navigator.userAgent&&t&&(t.WTCSGNL&&ut.includes(t.WTCSGNL.code)||t.WRAIN&&dt.includes(t.WRAIN.code))?(0,N.jsx)(ft,{variant:"outlined",className:pt.card,children:(0,N.jsx)(it.Z,{href:e("bad-weather-link"),target:"_blank",children:(0,N.jsx)(ct.Z,{children:(0,N.jsx)(D.Z,{children:e("bad-weather-text")})})})}):null},ut=["TC8NE","TC8SE","TC8NW","TC8SW","TC9","TC10"],dt=["WARINR","WRAINB"],pt={card:"".concat("route","-card")},ft=(0,T.ZP)(st.Z)((function(e){var t=e.theme;return(0,j.Z)({},"&.".concat(pt.card),(0,j.Z)({borderRadius:t.shape.borderRadius,margin:.2,height:"100%"},"> a",{height:"100%"}))})),xt=n(3433),gt=n(2547),ht=n(8310),mt=n(3135),Zt=n(421),jt=i.forwardRef((function(e,t){var n=e.geolocation,o=e.homeTab,r=e.onChangeTab,a=(0,i.useContext)(g.Z),c=a.hotRoute,s=a.savedEtas,l=a.db,u=l.holidays,d=l.routeList,p=l.stopList,f=a.isRouteFilter,x=a.collections,h=(0,i.useMemo)((function(){return(0,mt.HD)(u,new Date)}),[u]),m=(0,i.useRef)(o),j=(0,S.$)().t,b=(0,i.useState)(null),v=(0,O.Z)(b,2),y=v[0],C=v[1];(0,i.useImperativeHandle)(t,(function(){return{changeTab:function(e){m.current=e}}})),(0,i.useEffect)((function(){C(vt({geolocation:n,hotRoute:c,savedEtas:s,collections:x,routeList:d,stopList:p,isRouteFilter:f,isTodayHoliday:h}))}),[n]);var k=(0,i.useMemo)((function(){return y?(0,N.jsx)(ht.Z,{disablePadding:!0,children:y.both.split("|").map((function(e,t){return Boolean(e)&&(0,N.jsx)(Re.Z,{routeId:e},"route-shortcut-".concat(t))}))}):(0,N.jsx)(Zt.D,{sx:{my:10}})}),[y]),w=(0,i.useMemo)((function(){if(null===y)return(0,N.jsx)(Zt.D,{sx:{my:10}});var e=y.saved.split("|").every((function(e){return!e}));return(0,N.jsx)(i.Fragment,{children:e?(0,N.jsx)(D.Z,{sx:{marginTop:5},children:(0,N.jsx)("b",{children:j("\u672a\u6709\u6536\u85cf\u8def\u7dda")})}):(0,N.jsx)(ht.Z,{disablePadding:!0,children:y.saved.split("|").map((function(e,t){return Boolean(e)&&(0,N.jsx)(Re.Z,{routeId:e},"route-shortcut-".concat(t))}))})})}),[y,j]),_=(0,i.useMemo)((function(){return y?(0,N.jsx)(ht.Z,{disablePadding:!0,children:y.nearby.split("|").map((function(e,t){return Boolean(e)&&(0,N.jsx)(Re.Z,{routeId:e},"route-shortcut-".concat(t))}))}):(0,N.jsx)(Zt.D,{sx:{my:10}})}),[y]),T=(0,i.useMemo)((function(){return(null===y||void 0===y?void 0:y.collections.length)>0?(0,N.jsx)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:y.collections.map((function(e,t){var n=e.name,o=e.routes;return(0,N.jsxs)(Z.Z,{children:[(0,N.jsx)(D.Z,{variant:"body1",sx:{textAlign:"left"},children:(0,N.jsx)("b",{children:n})}),(0,N.jsx)(ht.Z,{disablePadding:!0,children:o.split("|").map((function(e,t){return Boolean(e)&&(0,N.jsx)(Re.Z,{routeId:e},"route-shortcut-".concat(t))}))}),0===o.split("|").filter((function(e){return Boolean(e)})).length&&(0,N.jsx)(D.Z,{sx:{marginTop:1},children:j("\u672a\u6709\u6536\u85cf\u8def\u7dda")})]},"collection-".concat(t))}))}):(0,N.jsx)(D.Z,{sx:{marginTop:5},children:(0,N.jsx)("b",{children:j("\u672a\u6709\u6536\u85cf\u8def\u7dda")})})}),[j,y]);return(0,i.useMemo)((function(){return(0,N.jsxs)(gt.ZP,{index:bt.indexOf(m.current),onChangeIndex:function(e){console.log(e),r(bt[e])},children:[k,w,_,T]})}),[r,k,w,_,T])})),bt=["both","saved","nearby","collections"],vt=function(e){var t=e.hotRoute,n=e.savedEtas,o=e.collections,r=e.geolocation,i=e.stopList,c=e.routeList,s=e.isRouteFilter,l=e.isTodayHoliday,u=n.concat(Object.entries(t).filter((function(e){var t=(0,O.Z)(e,2);t[0];return t[1]>5})).sort((function(e,t){return t[1]-e[1]})).map((function(e){return(0,O.Z)(e,1)[0]}))).filter((function(e,t,n){return n.indexOf(e)===t&&e.split("/")[0]in c})).map((function(e,t,n){var o=e.split("/"),a=(0,O.Z)(o,2),s=a[0],l=a[1],u=i[Object.values(c[s].stops).sort((function(e,t){return t.length-e.length}))[0][l]];return[e,(0,I.Sp)(r,u.location),n.length-t]})),d=Object.entries(i).map((function(e){return[].concat((0,xt.Z)(e),[(0,I.Sp)(e[1].location,r)])})).filter((function(e){return e[2]<1e3})).sort((function(e,t){return e[2]-t[2]})).slice(0,20).reduce((function(e,t){var n=(0,O.Z)(t,1)[0],o=[];return Object.entries(c).forEach((function(e){var t=(0,O.Z)(e,2),r=t[0],a=t[1];["kmb","nwfb","ctb","nlb"].forEach((function(e){a.stops[e]&&a.stops[e].includes(n)&&o.push(r+"/"+a.stops[e].indexOf(n))}))})),e.concat(o)}),[]),p=o.filter((function(e){return e.schedules.reduce((function(e,t){var n=t.day,o=t.start,r=t.end;if(e)return e;var a=new Date;a.setUTCHours(a.getUTCHours()+8);var i=a.getUTCDay();if(l&&0===n||n===i){var c=60*o.hour+o.minute,s=60*r.hour+r.minute,u=(60*a.getUTCHours()+a.getUTCMinutes())%1440;return c<=u&&u<=s}return!1}),!1)})).reduce((function(e,t){return e.push({name:t.name,routes:t.list}),e}),[]),f=function(e){return e.filter((function(e,t,n){return n.indexOf(e)===t})).filter((function(e){var t=e.split("/"),n=(0,O.Z)(t,1)[0];return c[n]&&(!s||(0,mt.x4)(n,c[n].freq,l))})).concat(Array(40).fill("")).slice(0,40).join("|")};return{saved:f(u.sort((function(e,t){return e[2]-t[2]})).map((function(e){return e[0]})).slice(0,40)),nearby:f(d),both:f([].concat(u.sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]})).slice(0,40)).concat(d)),collections:p.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{routes:f(e.routes)})}))}},yt=function(){var e=(0,S.$)().t,t=(0,i.useContext)(g.Z),n=t.db.updateTime,o=t.renewDb,r=(0,i.useMemo)((function(){return Date.now()>n+24192e5}),[n]);return"prerendering"!==navigator.userAgent&&r?(0,N.jsx)(kt,{variant:"outlined",className:Ct.card,onClick:o,children:(0,N.jsx)(it.Z,{children:(0,N.jsx)(ct.Z,{children:(0,N.jsx)(D.Z,{children:e("db-renew-text")})})})}):null},Ct={card:"".concat("db-renew","-card")},kt=(0,T.ZP)(st.Z)((function(e){var t=e.theme;return(0,j.Z)({},"&.".concat(Ct.card),{borderRadius:t.shape.borderRadius,margin:.2,height:"100%",display:"flex"})})),wt=function(){var e,t=(0,i.useContext)(g.Z),n=t.AppTitle,o=t.geolocation,r=(0,S.$)(),a=r.t,c=r.i18n,s=(0,i.useRef)(null),l=localStorage.getItem("homeTab"),u=(0,i.useState)("both"===(e=l)||"saved"===e||"nearby"===e||"collections"===e?l:"both"),d=(0,O.Z)(u,2),p=d[0],f=d[1];(0,i.useEffect)((function(){(0,I.ND)({title:"".concat(a("Dashboard")," - ").concat(a(n)),description:a("home-page-description"),lang:c.language})}),[c.language]);var x=(0,i.useState)(o),h=(0,O.Z)(x,2),m=h[0],Z=h[1],j=(0,i.useRef)(et()((function(){Z(o)}),1e3)).current;(0,i.useEffect)((function(){j(o)}),[o]);var b=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];f(e),console.log(e),localStorage.setItem("homeTab",e),s.current&&t&&s.current.changeTab(e)};return(0,N.jsxs)(Qe.Z,{sx:_t,square:!0,elevation:0,children:[(0,N.jsx)(D.Z,{component:"h1",style:Xe.Z,children:"".concat(a("Dashboard")," - ").concat(a(n))}),(0,N.jsx)(D.Z,{component:"h2",style:Xe.Z,children:a("home-page-description")}),(0,N.jsx)(rt,{homeTab:p,onChangeTab:b}),(0,N.jsx)(lt,{}),(0,N.jsx)(yt,{}),(0,N.jsx)(jt,{ref:s,homeTab:p,geolocation:m,onChangeTab:b})]})},_t={background:function(e){return"dark"===e.palette.mode?e.palette.background.default:"white"},textAlign:"center",display:"flex",flexDirection:"column",overflow:"auto",width:"100%"},St=n(5640),Tt=function(e){var t=e.name,n=e.delta,o=e.value,r=e.id;window.gtag?window.gtag("event",t,{value:n,metric_id:r,metric_value:o,metric_delta:n}):console.log("gtag not found")},It=function(e){e&&e instanceof Function&&n.e(27).then(n.bind(n,4027)).then((function(t){var n=t.getCLS,o=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),o(e),r(e),a(e),i(e)}))},Nt=n(1422),Wt=n(2586),Rt=function(){var e=(0,S.$)().t,t=(0,i.useContext)(g.Z),n=t.savedEtas,o=t.setSavedEtas,r=(0,i.useState)(JSON.stringify(n,null,2)),a=(0,O.Z)(r,2),c=a[0],s=a[1],l=(0,i.useState)(!1),u=(0,O.Z)(l,2),d=u[0],p=u[1];return(0,N.jsxs)(Z.Z,{sx:At,children:[(0,N.jsx)(D.Z,{variant:"h6",sx:{textAlign:"center"},children:e("\u8cc7\u6599\u532f\u51fa\u532f\u5165")}),(0,N.jsxs)(Z.Z,{sx:{display:"flex",flexDirection:"column",m:1},children:[(0,N.jsx)(ge.Z,{multiline:!0,value:c,onChange:function(e){var t=e.target.value;s(t);try{var n=JSON.parse(t);Array.isArray(n)&&o(n.filter((function(e){return"string"===typeof e||e instanceof String})))}catch(r){}}}),(0,N.jsx)(Z.Z,{sx:{m:1},children:(0,N.jsx)(L.Z,{onClick:function(){var e;null===(e=navigator.clipboard)||void 0===e||e.writeText(JSON.stringify(n,null,2)).then((function(){p(!0)}))},children:(0,N.jsx)(Wt.Z,{})})})]}),(0,N.jsx)(Nt.Z,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:d,autoHideDuration:1500,onClose:function(){p(!1)},message:e("\u5df2\u8907\u88fd\u5230\u526a\u8cbc\u7c3f")})]})},At={justifyContent:"center",flex:1},Pt=n(9840),Dt=n(2600),Et=n(3213),Ht=n(7018),Lt=n(5504),Mt=n(7181),$t=n(6267),Ft=function(){var e=(0,S.$)().t;return(0,N.jsxs)(Qe.Z,{sx:Ot,square:!0,elevation:0,children:[(0,N.jsxs)(ht.Z,{sx:{py:0},children:[(0,N.jsxs)(Pt.Z,{component:"a",href:"https://t.me/hkbusapp",target:"_blank",rel:"noreferrer",children:[(0,N.jsx)(Dt.Z,{children:(0,N.jsx)(H.Z,{children:(0,N.jsx)(Ht.Z,{})})}),(0,N.jsx)(Et.Z,{primary:e("Telegram \u4ea4\u6d41\u5340"),secondary:"https://t.me/hkbusapp"})]}),(0,N.jsxs)(Pt.Z,{component:"a",href:"mailto:info@hkbus.app",target:"_blank",rel:"noreferrer",children:[(0,N.jsx)(Dt.Z,{children:(0,N.jsx)(H.Z,{children:(0,N.jsx)(Lt.Z,{})})}),(0,N.jsx)(Et.Z,{primary:e("Email"),secondary:"info@hkbus.app"})]}),(0,N.jsxs)(Pt.Z,{component:"a",href:"https://instagram.com/hkbus.app",target:"_blank",rel:"noreferrer",children:[(0,N.jsx)(Dt.Z,{children:(0,N.jsx)(H.Z,{children:(0,N.jsx)(Mt.Z,{})})}),(0,N.jsx)(Et.Z,{primary:e("Instagram"),secondary:"@hkbus.app"})]}),(0,N.jsxs)(Pt.Z,{component:"a",href:"https://twitter.com/hkbusApp",target:"_blank",rel:"noreferrer",children:[(0,N.jsx)(Dt.Z,{children:(0,N.jsx)(H.Z,{children:(0,N.jsx)($t.Z,{})})}),(0,N.jsx)(Et.Z,{primary:e("Twitter"),secondary:"@hkbus.app"})]})]}),(0,N.jsx)(D.Z,{variant:"body1",children:e("\u6b61\u8fce\u610f\u898b\u53ca\u6280\u8853\u4ea4\u6d41")})]})},Ot={background:function(e){return"dark"===e.palette.mode?e.palette.background.default:"white"},textAlign:"center",display:"flex",flexDirection:"column",overflow:"auto",width:"100%",flex:1,gap:5,"& .MuiAvatar-colorDefault":{color:function(e){return"dark"===e.palette.mode?e.palette.background.default:"white"}}},zt=function(e){var t=e.url;return(0,i.useEffect)((function(){window.location.replace(t)}),[t]),(0,N.jsx)(D.Z,{variant:"body1",children:"Redirecting..."})},Bt=(0,c.ZP)((function(){return Promise.all([n.e(418),n.e(731)]).then(n.bind(n,1731))})),Ut=(0,c.ZP)((function(){return Promise.all([n.e(73),n.e(516)]).then(n.bind(n,5516))})),Gt=(0,c.ZP)((function(){return Promise.all([n.e(512),n.e(418),n.e(967),n.e(635)]).then(n.bind(n,1635))})),qt=(0,c.ZP)((function(){return Promise.all([n.e(272),n.e(546)]).then(n.bind(n,546))})),Kt=(0,c.ZP)((function(){return n.e(370).then(n.bind(n,3370))})),Vt=(0,c.ZP)((function(){return n.e(481).then(n.bind(n,7481))})),Jt=function(){var e=(0,i.useContext)(g.Z),t=e.colorMode,n=e.analytics,o=(0,S.$)().i18n.language;n&&It(Tt);var r=(0,i.useMemo)((function(){return(0,s.Z)(Xt(t),[t])}),[t]);return(0,N.jsx)(l.Z,{injectFirst:!0,children:(0,N.jsx)(u.Z,{theme:r,children:(0,N.jsx)(f.C,{value:Qt,children:(0,N.jsx)(d.VK,{children:(0,N.jsx)(St.N,{children:(0,N.jsxs)(p.Z5,{children:[(0,N.jsx)(p.AW,{path:"/",element:(0,N.jsx)(p.Fg,{to:"/".concat(o)})}),(0,N.jsxs)(p.AW,{path:"/:lang",element:(0,N.jsx)(Je,{}),children:[(0,N.jsx)(p.AW,{path:"route/:id",element:(0,N.jsx)(Bt,{})}),(0,N.jsx)(p.AW,{path:"route/:id/:panel",element:(0,N.jsx)(Bt,{})}),(0,N.jsx)(p.AW,{path:"settings",element:(0,N.jsx)(qt,{})}),(0,N.jsx)(p.AW,{path:"qr-code",element:(0,N.jsx)(Rt,{})}),(0,N.jsx)(p.AW,{path:"board",element:(0,N.jsx)(Ut,{})}),(0,N.jsx)(p.AW,{path:"search",element:(0,N.jsx)(Gt,{})}),(0,N.jsx)(p.AW,{path:"privacy",element:(0,N.jsx)(Kt,{})}),(0,N.jsx)(p.AW,{path:"terms",element:(0,N.jsx)(Vt,{})}),(0,N.jsx)(p.AW,{path:"support",element:(0,N.jsx)(Ft,{})}),(0,N.jsx)(p.AW,{path:"patreon",element:(0,N.jsx)(zt,{url:"https://www.patreon.com/hkbus"})}),(0,N.jsx)(p.AW,{path:"",element:(0,N.jsx)(wt,{})})]})]})})})})})})},Qt=(0,x.Z)({key:"hkbus",speedy:!("prerendering"===navigator.userAgent)}),Xt=function(e){return{typography:{fontFamily:"'Chiron Sans HK Pro WS', sans-serif",h6:{fontSize:"1.2rem",fontWeight:700}},palette:(0,a.Z)({mode:e},"light"===e?{background:{default:"#fedb00"},primary:{main:"#fedb00",contrastText:"rgba(0, 0, 0, 0.12)"}}:{background:{default:"#000",contrast:"rgba(255, 255, 255, 0.12)"},primary:{main:"#fedb00"}}),elements:{MuiCssBaseline:{styleOverrides:{html:{userSelect:"none"},body:{fontSize:"0.875rem",lineHeight:1.43,scrollbarColor:"#3f3f3f",scrollbarWidth:"thin"}}}}}}},5640:function(e,t,n){n.d(t,{N:function(){return c}});var o=n(9439),r=n(7313),a=n(6417),i=r.createContext({}),c=function(e){var t=(0,r.useState)({start:null,end:null}),n=(0,o.Z)(t,2),c=n[0],s=n[1],l=(0,r.useState)("ready"),u=(0,o.Z)(l,2),d=u[0],p=u[1],f=(0,r.useState)([]),x=(0,o.Z)(f,2),g=x[0],h=x[1],m=(0,r.useState)({resultIdx:0,stopIdx:[0,0]}),Z=(0,o.Z)(m,2),j=Z[0],b=Z[1];return(0,a.jsx)(i.Provider,{value:{locations:c,setLocations:s,status:d,setStatus:p,result:g,setResult:h,resultIdx:j,setResultIdx:b},children:e.children})};t.Z=i},9878:function(e,t,n){n.d(t,{e:function(){return l}});var o=n(1413),r=n(9439),a=n(7313),i=n(4511),c=n(7420),s=n(6060),l=function(e){var t=(0,a.useContext)(s.Z),n=t.db.routeList,l=t.isVisible,d=t.refreshInterval,p=e.split("/"),f=(0,r.Z)(p,2),x=f[0],g=f[1],h=n[x]||u,m=(0,a.useState)(null),Z=(0,r.Z)(m,2),j=Z[0],b=Z[1],v=(0,i.$)().i18n.language,y=(0,a.useRef)(!1),C=(0,a.useCallback)((function(){return l&&"prerendering"!==navigator.userAgent?(0,c.fetchEtas)((0,o.Z)((0,o.Z)({},h),{},{seq:parseInt(g,10),language:v})).then((function(e){y.current&&b(e)})):(b(null),new Promise((function(e){return e([])})))}),[l,v,h,g]);return(0,a.useEffect)((function(){y.current=!0;var e=setInterval((function(){C()}),d);return C(),function(){y.current=!1,clearInterval(e)}}),[e,C,d]),j},u={co:[""],stops:{"":[""]},dest:{zh:"",en:""},bound:"",nlbId:0,gtfsId:"",fares:[],faresHoliday:[]}},421:function(e,t,n){n.d(t,{D:function(){return p},u:function(){return d}});var o=n(1413),r=n(5987),a=n(7313),i=n(9176),c=n(5281),s=n(6417),l=["sx","color"],u=["sx","color"],d=a.forwardRef((function(e,t){var n=e.sx,a=e.color,c=(0,r.Z)(e,l);return(0,s.jsx)(i.Z,(0,o.Z)({color:null!==a&&void 0!==a?a:"inherit",sx:(0,o.Z)({m:1,height:5,borderRadius:5},n),ref:t},c))})),p=a.forwardRef((function(e,t){var n=e.sx,a=e.color,i=(0,r.Z)(e,u);return(0,s.jsx)(c.Z,(0,o.Z)({color:null!==a&&void 0!==a?a:"inherit",sx:(0,o.Z)({m:1},n),ref:t},i))}))},1660:function(e,t,n){n.d(t,{Z:function(){return T}});var o=n(4942),r=n(9439),a=n(7313),i=n(3213),c=n(1113),s=n(7829),l=n(9536),u=n(7216),d=n(6480),p=n(8467),f=n(2135),x=n(5823),g=n(7592),h=n(6060),m=n(4511),Z=n(9878),j=n(6417),b=function(e){var t=e.routeId,n=(0,m.$)(),o=n.t,r=n.i18n,i=(0,a.useContext)(h.Z).etaFormat,s=(0,Z.e)(t),l=function(e){if(!e||!e.eta)return"";var t=Math.round((new Date(e.eta).getTime()-(new Date).getTime())/60/1e3);if(!Number.isInteger(t))return e.remark[r.language];var n=e.eta.slice(11,16),a=t<1?"- ".concat(o("\u5206\u9418")):"".concat(t," ").concat(o("\u5206\u9418"));switch(i){case"exact":return n;case"diff":return a;default:return"".concat(n," (").concat(a,")")}};return(0,j.jsx)(C,{primary:(0,j.jsx)(c.Z,{component:"h5",color:"textPrimary",sx:{whiteSpace:"nowrap"},children:s?l(s[0]):""}),secondary:(0,j.jsxs)(c.Z,{variant:"h6",color:"textSecondary",className:y.secondary,children:[s?l(s[1]):"",(0,j.jsx)("br",{}),s?l(s[2]):""]}),className:y.root})},v="etas",y={root:"".concat(v,"-root"),secondary:"".concat(v,"-secondary")},C=(0,g.ZP)(i.Z)((function(e){var t;e.theme;return t={},(0,o.Z)(t,"&.".concat(y.root),{textAlign:"right"}),(0,o.Z)(t,"& .".concat(y.secondary),{fontSize:"0.875rem",fontWeight:"400",lineHeight:"1.43",whiteSpace:"nowrap",textAlign:"right"}),t})),k=n(9530),w=function(e){var t=e.name,n=e.location,o=e.fares,r=e.faresHoliday,i=e.seq,c=(0,m.$)().t,s=(0,a.useContext)(h.Z),l=s.geoPermission,u=s.geolocation,d=[o&&o[i]?"$"+o[i]:"",r&&r[i]?"$"+r[i]:""].filter((function(e){return e})).join(", "),p=(0,x.Qi)(n,u),f=p.distance,g=p.unit,Z=p.decimalPlace;return"granted"!==l||0===n.lat?(0,j.jsx)(j.Fragment,{children:t+"\u3000"+(d?"("+d+")":"")}):(0,j.jsx)(j.Fragment,{children:t+" - "+f.toFixed(Z)+c(g)+"\u3000"+(d?"("+d+")":"")})},_={co:[""],stops:{"":[""]},dest:{zh:"",en:""},bound:"",nlbId:0,fares:[],faresHoliday:[]},S={location:{lat:0,lng:0},name:{zh:"",en:""}},T=function(e){var t=e.routeId,n=e.disabled,o=void 0!==n&&n,u=(0,m.$)(),g=u.t,Z=u.i18n,v=(0,a.useContext)(h.Z),y=v.db,C=y.routeList,T=y.stopList,N=v.vibrateDuration,P=t.split("-"),D=(0,r.Z)(P,1)[0],E=t.split("/"),H=(0,r.Z)(E,2),L=H[0],M=H[1],$=C[L]||_,F=$.co,O=$.stops,z=$.dest,B=$.fares,U=$.faresHoliday,G=T[I(F,O)[parseInt(M,10)]]||S,q=(0,p.s0)();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(R,{component:o?void 0:f.rU,to:"/".concat(Z.language,"/route/").concat(L.toLowerCase()),onClick:o?function(){}:function(e){e.preventDefault(),(0,x.tp)(N),setTimeout((function(){q("/".concat(Z.language,"/route/").concat(t.toLowerCase()))}),0)},className:W.listItem,children:[(0,j.jsx)(i.Z,{primary:(0,j.jsx)(k.Z,{routeNo:D})}),(0,j.jsx)(i.Z,{primary:(0,j.jsxs)(c.Z,{component:"h3",variant:"h6",color:"textPrimary",className:W.fromToWrapper,children:[(0,j.jsx)("span",{className:W.fromToText,children:g("\u5f80")}),(0,j.jsx)("b",{children:(0,x.iF)(z[Z.language])})]}),secondary:(0,j.jsx)(w,{name:(0,x.iF)(G.name[Z.language]),location:G.location,fares:B,faresHoliday:U,seq:parseInt(M,10)}),secondaryTypographyProps:{component:"h4",variant:"subtitle2"},className:W.routeDest}),o?(0,j.jsx)(s.Z,{sx:A,children:(0,j.jsx)(d.Z,{})}):(0,j.jsx)(b,{routeId:t})]}),(0,j.jsx)(l.Z,{})]})},I=function(e,t){for(var n=0;n<e.length;++n)if(e[n]in t)return t[e[n]]},N="succinctTimeReport",W={listItem:"".concat(N,"-listItem"),route:"".concat(N,"-route"),routeDest:"".concat(N,"-routeDest"),fromToWrapper:"".concat(N,"-fromToWrapper"),fromToText:"".concat(N,"-fromToText")},R=(0,g.ZP)(u.ZP)((function(e){var t,n=e.theme;return t={display:"grid",gap:n.spacing(1),gridTemplateColumns:"15% 1fr minmax(18%, max-content)"},(0,o.Z)(t,"&.".concat(W.listItem),{padding:"".concat(n.spacing(.5)," ").concat(n.spacing(1)),color:"rgba(0,0,0,0.87)"}),(0,o.Z)(t,"& .".concat(W.routeDest),{overflow:"hidden"}),(0,o.Z)(t,"& .".concat(W.fromToWrapper),{display:"flex",alignItems:"baseline"}),(0,o.Z)(t,"& .".concat(W.fromToText),{fontSize:"0.85rem",marginRight:n.spacing(.5)}),t})),A={color:function(e){return e.palette.text.primary},flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},9530:function(e,t,n){var o=n(4942),r=n(9439),a=(n(7313),n(1113)),i=n(7592),c=n(6417);t.Z=function(e){var t=e.routeNo,n=e.component,o=e.align,a=t.match(/[0-9][A-Z]+$/)?[t.slice(0,-1),t.slice(-1)]:[t,""],i=(0,r.Z)(a,2),s=i[0],d=i[1];return(0,c.jsxs)(u,{component:n||"h2",align:o,variant:"caption",color:"textPrimary",className:l.root,children:[(0,c.jsx)("span",{className:l.prefix,children:s}),(0,c.jsx)("span",{className:l.suffix,children:d})]})};var s="routeNo",l={root:"".concat(s,"-root"),prefix:"".concat(s,"-prefix"),suffix:"".concat(s,"-suffix")},u=(0,i.ZP)(a.Z)((function(e){var t;e.theme;return t={},(0,o.Z)(t,"&.".concat(l.root),{lineHeight:"normal",display:"inline"}),(0,o.Z)(t,"& .".concat(l.prefix),{fontSize:"1.5rem",fontFamily:'"Oswald", sans-serif'}),(0,o.Z)(t,"& .".concat(l.suffix),{fontSize:"1.2rem",fontFamily:'"Oswald", sans-serif'}),t}))},3135:function(e,t,n){n.d(t,{HD:function(){return i},x4:function(){return c}});var o=n(9439),r={266:[0,0,1,1,1,0,0],271:[0,1,1,1,1,0,0],272:[0,0,0,0,0,1,0],287:[0,1,1,1,1,1,0],288:[0,0,0,0,0,0,1],319:[0,1,1,1,1,1,1],320:[1,0,0,0,0,0,0],415:[0,1,1,1,1,1,0],416:[1,0,0,0,0,0,1],447:[0,1,1,1,1,1,1],448:[1,0,0,0,0,0,0],480:[1,0,0,0,0,0,1],511:[1,1,1,1,1,1,1],31:[0,1,1,1,1,1,0],63:[0,1,1,1,1,1,1],111:[1,1,0,1,1,1,1]},a=function(e,t){var n=24*e*60;return n+=60*parseInt(t.slice(0,2),10)+parseInt(t.slice(2),10)},i=function(e,t){return e.includes("".concat(t.getFullYear()).concat(("0"+(t.getMonth()+1)).slice(-2)).concat(("0"+t.getDate()).slice(-2)))},c=function(e,t,n){if(!t)return!0;var i=!1,c=new Date,s=a(n?0:c.getDay(),("0"+c.getHours()).slice(-2)+("0"+c.getMinutes()).slice(-2));return Object.entries(t).forEach((function(t){var n=(0,o.Z)(t,2),c=n[0],l=n[1];try{r[c].forEach((function(e,t){e&&Object.entries(l).forEach((function(e){var n,r,c,l=(0,o.Z)(e,2),u=l[0],d=l[1],p=a(t,u),f=a(t,d?d[0]:u);i=i||(r=f,(n=p)-60<=(c=s)&&c<=r+60||n-60<=c+10080&&c+10080<=r+60)}))}))}catch(u){console.log(e+" has unknown service ID")}})),i}}}]);